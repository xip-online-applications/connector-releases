{
  "version": 3,
  "sources": ["../../../../../../../libs/connector-runner-factorynebula-source/src/lib/connector-runner-factorynebula-source.ts"],
  "sourcesContent": ["import { ConnectorRuntime } from '@transai/connector-runtime';\nimport { ApiResultHandler } from './api-result.handler';\nimport { ApiExtractorService } from './api-extractor/api-extractor.service';\nimport { ApiSourceConfig, isApiSourceConfigType } from './types';\nimport { KafkaService } from './kafka/kafka.service';\n\nexport class ConnectorRunnerFactorynebulaSource extends ConnectorRuntime<ApiSourceConfig> {\n  readonly CONNECTOR_INSTANCE: string = 'XOD_CONNECTOR_API_SOURCE_CONFIG';\n\n  private kafkaWrapper: KafkaService | undefined = undefined;\n\n  #apiExtractorServices: Array<ApiExtractorService> = [];\n\n  override init = async (): Promise<void> => {\n    const store = this.offsetStoreInstance;\n    if (!store) {\n      throw new Error(\n        'Offset store is not defined. Please provide an temp location for the offset store.',\n      );\n    }\n\n    const config = this.config!;\n\n    this.kafkaWrapper = new KafkaService(this.kafkaService!);\n\n    const apiResultHandler = new ApiResultHandler(\n      config,\n      this.kafkaWrapper,\n      store,\n    );\n\n    this.#apiExtractorServices = config.apiCalls.map(\n      (apiConfig) =>\n        new ApiExtractorService(config, apiConfig, apiResultHandler, store),\n    );\n  };\n\n  override exit = async () => {\n    this.#apiExtractorServices.forEach((service) => service.stop());\n    this.#apiExtractorServices = [];\n  };\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAiC;AACjC,wBAAiC;AACjC,2BAAoC;AAEpC,mBAA6B;AAEtB,MAAM,2CAA2C,0CAAkC;AAAA,EAAnF;AAAA;AACL,SAAS,qBAA6B;AAEtC,SAAQ,eAAyC;AAEjD,iCAAoD,CAAC;AAErD,SAAS,OAAO,YAA2B;AACzC,YAAM,QAAQ,KAAK;AACnB,UAAI,CAAC,OAAO;AACV,cAAM,IAAI;AAAA,UACR;AAAA,QACF;AAAA,MACF;AAEA,YAAM,SAAS,KAAK;AAEpB,WAAK,eAAe,IAAI,0BAAa,KAAK,YAAa;AAEvD,YAAM,mBAAmB,IAAI;AAAA,QAC3B;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACF;AAEA,WAAK,wBAAwB,OAAO,SAAS;AAAA,QAC3C,CAAC,cACC,IAAI,yCAAoB,QAAQ,WAAW,kBAAkB,KAAK;AAAA,MACtE;AAAA,IACF;AAEA,SAAS,OAAO,YAAY;AAC1B,WAAK,sBAAsB,QAAQ,CAAC,YAAY,QAAQ,KAAK,CAAC;AAC9D,WAAK,wBAAwB,CAAC;AAAA,IAChC;AAAA;AAAA,EA7BA;AA8BF;",
  "names": []
}
