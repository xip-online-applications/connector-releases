{
  "version": 3,
  "sources": ["../../../../../../../libs/connector-runner-microsoft-office365-email/src/lib/connector-runner-microsoft-office365-email.ts"],
  "sourcesContent": ["import {\n  ConnectorRuntimeSDK,\n  ConnectorSDKInterface,\n} from '@transai/connector-runtime-sdk';\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { MailClient } from '@xip-online-data/microsoft-office365-mail-client';\nimport { ConnectorInterface } from '@xip-online-data/types';\n\nimport { ActionsHandler } from './actions-handler';\nimport { MailProcessor } from './mail-processor';\nimport { ConnectorConfig } from './types';\n\nexport class ConnectorRunnerMicrosoftOffice365Email extends ConnectorRuntimeSDK<ConnectorConfig> {\n  readonly #mailClient: MailClient;\n\n  readonly #actionsHandler: ActionsHandler;\n\n  constructor(\n    connector: ConnectorInterface,\n    connectorSDK: ConnectorSDKInterface,\n  ) {\n    super(connector, connectorSDK);\n\n    const { config } = this.connectorSDK;\n    this.#mailClient = new MailClient(config.mailConfig);\n\n    this.#actionsHandler = new ActionsHandler(\n      this.connectorSDK,\n      this.#mailClient,\n    );\n\n    this.callbackFunction = this.#actionsHandler.callbackFunctionChain;\n  }\n\n  override init = async (): Promise<void> => {\n    const { config } = this.connectorSDK;\n\n    await Promise.all(\n      config.mailboxes.map(async (mailSourceConfig) => {\n        const mailProcessor = new MailProcessor(\n          this.connectorSDK,\n          mailSourceConfig,\n          this.#mailClient,\n        );\n\n        await this.connectorSDK.processing.registerInterval(\n          mailSourceConfig.interval ?? mailProcessor.DEFAULT_INTERVAL_SECONDS,\n          mailProcessor,\n          { immediate: true },\n        );\n      }),\n    );\n  };\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAGO;AAEP,6CAA2B;AAG3B,6BAA+B;AAC/B,4BAA8B;AAGvB,MAAM,+CAA+C,iDAAqC;AAAA,EAK/F,YACE,WACA,cACA;AACA,UAAM,WAAW,YAAY;AAa/B,SAAS,OAAO,YAA2B;AACzC,YAAM,EAAE,OAAO,IAAI,KAAK;AAExB,YAAM,QAAQ;AAAA,QACZ,OAAO,UAAU,IAAI,OAAO,qBAAqB;AAC/C,gBAAM,gBAAgB,IAAI;AAAA,YACxB,KAAK;AAAA,YACL;AAAA,YACA,KAAK;AAAA,UACP;AAEA,gBAAM,KAAK,aAAa,WAAW;AAAA,YACjC,iBAAiB,YAAY,cAAc;AAAA,YAC3C;AAAA,YACA,EAAE,WAAW,KAAK;AAAA,UACpB;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AA7BE,UAAM,EAAE,OAAO,IAAI,KAAK;AACxB,SAAK,cAAc,IAAI,kDAAW,OAAO,UAAU;AAEnD,SAAK,kBAAkB,IAAI;AAAA,MACzB,KAAK;AAAA,MACL,KAAK;AAAA,IACP;AAEA,SAAK,mBAAmB,KAAK,gBAAgB;AAAA,EAC/C;AAAA,EAnBS;AAAA,EAEA;AAsCX;",
  "names": []
}
