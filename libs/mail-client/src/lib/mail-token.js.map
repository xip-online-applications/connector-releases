{
  "version": 3,
  "sources": ["../../../../../../../libs/mail-client/src/lib/mail-token.ts"],
  "sourcesContent": ["// mail-token.ts\nimport https from 'https';\nimport querystring from 'querystring';\n\nexport async function getAccessToken(\n  tenantId: string,\n  clientId: string,\n  clientSecret: string,\n): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const postData = querystring.stringify({\n      client_id: clientId,\n      scope: 'https://outlook.office365.com/.default',\n      client_secret: clientSecret,\n      grant_type: 'client_credentials',\n    });\n\n    const options = {\n      hostname: 'login.microsoftonline.com',\n      path: `/${tenantId}/oauth2/v2.0/token`,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n        'Content-Length': Buffer.byteLength(postData),\n      },\n    };\n\n    const req = https.request(options, (res) => {\n      let data = '';\n      res.on('data', (chunk) => {\n        data += chunk;\n      });\n      res.on('end', () => {\n        try {\n          const parsed = JSON.parse(data);\n          resolve(parsed.access_token);\n        } catch (err) {\n          reject(err);\n        }\n      });\n    });\n\n    req.on('error', (e) => {\n      reject(e);\n    });\n\n    req.write(postData);\n    req.end();\n  });\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,mBAAkB;AAClB,yBAAwB;AAExB,eAAsB,eACpB,UACA,UACA,cACiB;AACjB,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAM,WAAW,mBAAAA,QAAY,UAAU;AAAA,MACrC,WAAW;AAAA,MACX,OAAO;AAAA,MACP,eAAe;AAAA,MACf,YAAY;AAAA,IACd,CAAC;AAED,UAAM,UAAU;AAAA,MACd,UAAU;AAAA,MACV,MAAM,IAAI,QAAQ;AAAA,MAClB,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,kBAAkB,OAAO,WAAW,QAAQ;AAAA,MAC9C;AAAA,IACF;AAEA,UAAM,MAAM,aAAAC,QAAM,QAAQ,SAAS,CAAC,QAAQ;AAC1C,UAAI,OAAO;AACX,UAAI,GAAG,QAAQ,CAAC,UAAU;AACxB,gBAAQ;AAAA,MACV,CAAC;AACD,UAAI,GAAG,OAAO,MAAM;AAClB,YAAI;AACF,gBAAM,SAAS,KAAK,MAAM,IAAI;AAC9B,kBAAQ,OAAO,YAAY;AAAA,QAC7B,SAAS,KAAK;AACZ,iBAAO,GAAG;AAAA,QACZ;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,GAAG,SAAS,CAAC,MAAM;AACrB,aAAO,CAAC;AAAA,IACV,CAAC;AAED,QAAI,MAAM,QAAQ;AAClB,QAAI,IAAI;AAAA,EACV,CAAC;AACH;",
  "names": ["querystring", "https"]
}
