{
  "version": 3,
  "sources": ["../../../../../../../libs/management-api-client/src/lib/management-api-client.ts"],
  "sourcesContent": ["import {\n  CacheBuilderOptions,\n  HttpServiceBuilder,\n  HttpServiceInterface\n} from '@xip-online-data/httpclient';\n\nexport abstract class AbstractManagementApiClient {\n  readonly #clientId: string;\n\n  readonly #clientSecret: string;\n\n  readonly #tenantIdentifier: string;\n\n  readonly #managementApiUrl: string;\n\n  readonly #audience: string;\n\n  readonly #identityProviderUrl: string;\n\n  readonly #auth0_orgIdentifier: string;\n\n  readonly #client: HttpServiceInterface;\n\n  constructor() {\n    this.#clientId = process.env['MANAGEMENT_API_CLIENT_ID'] ?? '';\n    this.#clientSecret = process.env['MANAGEMENT_API_CLIENT_SECRET'] ?? '';\n    this.#managementApiUrl = process.env['MANAGEMENT_API_URL'] ?? '';\n    this.#audience = process.env['AUDIENCE'] ?? '';\n    this.#identityProviderUrl = process.env['IDENTITY_PROVIDER_URL'] ?? '';\n    this.#auth0_orgIdentifier = process.env['AUTH0_ORG_IDENTIFIER'] ?? '';\n    this.#tenantIdentifier = process.env['TENANT_IDENTIFIER'] ?? '';\n\n    if (\n      !this.#clientId ||\n      !this.#clientSecret ||\n      !this.#managementApiUrl ||\n      !this.#audience ||\n      !this.#identityProviderUrl ||\n      !this.#auth0_orgIdentifier ||\n      !this.#tenantIdentifier\n    ) {\n      throw new Error('Missing required environment variables');\n    }\n\n    this.#client = HttpServiceBuilder.build({\n      baseUrl: this.#managementApiUrl,\n      jwt: {\n        tokenUrl: `${this.#identityProviderUrl}/oauth/token`,\n        clientId: this.#clientId,\n        clientSecret: this.#clientSecret,\n        audience: this.#audience,\n        tenantIdentifier: this.#tenantIdentifier,\n      },\n      cache: this.#getCacheOptions(),\n    });\n  }\n\n  protected async get<T>(\n    path: string,\n    queryParams?: Record<string, string | number | boolean>,\n  ): Promise<T> {\n    return this.#client.get<T>(path, {}, queryParams);\n  }\n\n  protected async put<T>(path: string, body: object): Promise<T> {\n    return this.#client.put<T>(path, body);\n  }\n\n  protected async post<T>(path: string, body: object): Promise<T> {\n    return this.#client.post<T>(path, body);\n  }\n\n  #getCacheOptions(): CacheBuilderOptions {\n    switch (process.env['TOKEN_CACHE']) {\n      case 'memory':\n        return { type: 'memory' };\n      case 'redis':\n        return {\n          type: 'redis',\n          redisUrl: process.env['REDIS_URL'] ?? '',\n          keyPrefix: process.env['REDIS_KEY_PREFIX'] ?? '',\n        };\n      case 'filesystem':\n        return {\n          type: 'filesystem',\n          path: process.env['FILESYSTEM_CACHE_PATH'] ?? './cache',\n          keyPrefix: process.env['FILESYSTEM_CACHE_PREFIX'],\n        };\n      default:\n        return { type: 'memory' };\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAIO;AAEA,MAAe,4BAA4B;AAAA,EACvC;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAEA;AAAA,EAET,cAAc;AACZ,SAAK,YAAY,QAAQ,IAAI,0BAA0B,KAAK;AAC5D,SAAK,gBAAgB,QAAQ,IAAI,8BAA8B,KAAK;AACpE,SAAK,oBAAoB,QAAQ,IAAI,oBAAoB,KAAK;AAC9D,SAAK,YAAY,QAAQ,IAAI,UAAU,KAAK;AAC5C,SAAK,uBAAuB,QAAQ,IAAI,uBAAuB,KAAK;AACpE,SAAK,uBAAuB,QAAQ,IAAI,sBAAsB,KAAK;AACnE,SAAK,oBAAoB,QAAQ,IAAI,mBAAmB,KAAK;AAE7D,QACE,CAAC,KAAK,aACN,CAAC,KAAK,iBACN,CAAC,KAAK,qBACN,CAAC,KAAK,aACN,CAAC,KAAK,wBACN,CAAC,KAAK,wBACN,CAAC,KAAK,mBACN;AACA,YAAM,IAAI,MAAM,wCAAwC;AAAA,IAC1D;AAEA,SAAK,UAAU,qCAAmB,MAAM;AAAA,MACtC,SAAS,KAAK;AAAA,MACd,KAAK;AAAA,QACH,UAAU,GAAG,KAAK,oBAAoB;AAAA,QACtC,UAAU,KAAK;AAAA,QACf,cAAc,KAAK;AAAA,QACnB,UAAU,KAAK;AAAA,QACf,kBAAkB,KAAK;AAAA,MACzB;AAAA,MACA,OAAO,KAAK,iBAAiB;AAAA,IAC/B,CAAC;AAAA,EACH;AAAA,EAEA,MAAgB,IACd,MACA,aACY;AACZ,WAAO,KAAK,QAAQ,IAAO,MAAM,CAAC,GAAG,WAAW;AAAA,EAClD;AAAA,EAEA,MAAgB,IAAO,MAAc,MAA0B;AAC7D,WAAO,KAAK,QAAQ,IAAO,MAAM,IAAI;AAAA,EACvC;AAAA,EAEA,MAAgB,KAAQ,MAAc,MAA0B;AAC9D,WAAO,KAAK,QAAQ,KAAQ,MAAM,IAAI;AAAA,EACxC;AAAA,EAEA,mBAAwC;AACtC,YAAQ,QAAQ,IAAI,aAAa,GAAG;AAAA,MAClC,KAAK;AACH,eAAO,EAAE,MAAM,SAAS;AAAA,MAC1B,KAAK;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,UAAU,QAAQ,IAAI,WAAW,KAAK;AAAA,UACtC,WAAW,QAAQ,IAAI,kBAAkB,KAAK;AAAA,QAChD;AAAA,MACF,KAAK;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,MAAM,QAAQ,IAAI,uBAAuB,KAAK;AAAA,UAC9C,WAAW,QAAQ,IAAI,yBAAyB;AAAA,QAClD;AAAA,MACF;AACE,eAAO,EAAE,MAAM,SAAS;AAAA,IAC5B;AAAA,EACF;AACF;",
  "names": []
}
